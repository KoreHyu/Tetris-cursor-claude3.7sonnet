---

# テトリスアプリケーション開発指示書

---

### 1. はじめに

本指示書は、古典的なパズルゲーム「**テトリス**」のアプリケーション開発に関する要件を定義します。プレイヤーがテトリミノを操作し、ラインを揃えてスコアを獲得する基本的なゲームプレイに加え、現代的なUI/UXを考慮した機能の実装を目指します。

---

### 2. 目的

* 直感的で楽しいテトリスゲーム体験の提供。
* 様々なプラットフォームでの動作を考慮した柔軟な設計。
* 将来的な機能拡張に対応可能なモジュール化されたコードベースの構築。

---

### 3. ターゲットユーザー

* テトリスを初めてプレイする人から、熟練者まで幅広い層。
* 暇つぶしやリフレッシュ目的でゲームをプレイする人。

---

### 4. 機能要件

#### 4.1. ゲームプレイ機能

* **テトリミノの生成:**
    * 7種類のテトリミノ（I, O, T, S, Z, J, L）をランダムに生成します。
    * 次に出現するテトリミノ（**Next Tetromino**）を表示します。
* **テトリミノの操作:**
    * 左右移動 (Left/Right)
    * 回転 (Rotate Clockwise/Counter-Clockwise)
    * **ソフトドロップ** (Soft Drop): 落下速度を一時的に増加させます。
    * **ハードドロップ** (Hard Drop): テトリミノを即座に最下部まで落下させます。
    * **ホールド** (Hold): 現在のテトリミノを一時的に保持し、後で使用できるようにします。
* **ブロックの固定:**
    * テトリミノが他のブロックまたは床に接触した際に固定します。
    * 接地後、一定時間操作可能な猶予（**Lock Delay**）を提供します。
* **ラインクリア:**
    * 横一列がブロックで埋まった場合にラインをクリアします。
    * 複数ライン同時クリア（Double, Triple, Tetris）の判定とスコア加算を行います。
* **ゲームオーバー:**
    * フィールドの最上部までブロックが積み上がった場合にゲームオーバーとします。
* **スコア計算:**
    * ラインクリア数に応じたスコアを加算します。
    * ソフトドロップ、ハードドロップによるスコア加算を行います。
    * レベルアップに応じたスコア倍率の変化を適用します。
* **レベルシステム:**
    * 一定数のラインクリアごとにレベルが上昇します。
    * レベル上昇に伴い、テトリミノの落下速度が上昇します。

#### 4.2. UI/UX機能

* **ゲーム画面:**
    * ゲームフィールド（10x20グリッドを標準とします）
    * 現在のスコア表示
    * 現在のレベル表示
    * クリアしたライン数表示
    * Next Tetromino表示
    * Hold Tetromino表示
    * ゴースト（**Ghost Piece**）表示: ハードドロップでテトリミノが着地する位置のプレビュー。
* **ポーズ機能:**
    * ゲームの一時停止/再開を可能にします。
    * ポーズメニューからの設定変更、ゲーム終了などを提供します。
* **ゲームオーバー画面:**
    * 最終スコアを表示します。
    * ハイスコアランキングを表示します。
    * リトライボタン、タイトル画面に戻るボタンを配置します。
* **タイトル画面:**
    * ゲームスタートボタン、設定ボタン、ハイスコア表示ボタン、ゲーム終了ボタンを配置します。
* **設定画面:**
    * 操作方法のカスタマイズ（キーボード、タッチなど）を可能にします。
    * 音量調整（BGM, SE）を提供します。
    * 難易度設定（任意）を可能にします。

#### 4.3. その他の機能

* **ハイスコアランキング:**
    * ローカルストレージにハイスコアを保存し、表示します。
    * 上位N件のスコアとプレイヤー名（任意）を記録します。
* **BGMとSE:**
    * ゲームプレイ中のBGMを再生します。
    * テトリミノ移動、回転、接地、ラインクリア、ゲームオーバーなどのSEを再生します。

---

### 5. 非機能要件

* **パフォーマンス:** スムーズなゲームプレイ（**60FPS**を目標）を実現し、テトリミノの落下、回転、ラインクリアなどのアニメーションが滑らかであること。
* **安定性:** クラッシュやフリーズが発生しないこと。長時間のプレイでも問題なく動作すること。
* **拡張性:** 将来的な新機能（例：対戦モード、異なるゲームモード、スキンなど）の追加が容易であること。
* **保守性:** 適切にコメントが記述された、理解しやすいコードであること。モジュール化された設計により、変更が容易であること。
* **レスポンシブデザイン（Web/モバイルの場合）:** 様々な画面サイズやアスペクト比に対応できること。

---

### 6. 技術スタック（推奨）

具体的な技術スタックは、開発者の経験やターゲットプラットフォームによって異なりますが、一般的な選択肢を以下に示します。

* **Webアプリケーションの場合:**
    * **フロントエンド:** HTML5, CSS3, JavaScript (React, Vue.js, Svelteなどのフレームワーク/ライブラリも検討)
    * **描画:** Canvas API または WebGL (three.jsなど)
* **デスクトップアプリケーションの場合:**
    * **Python:** Pygame, Kivy
    * **C#:** Unity, MonoGame, WPF
    * **Java:** JavaFX, Swing
* **モバイルアプリケーションの場合:**
    * **Unity (C#):** クロスプラットフォーム開発
    * **React Native / Flutter:** クロスプラットフォーム開発
    * **Swift (iOS) / Kotlin (Android):** ネイティブ開発

---

### 7. 開発フェーズ

1.  **企画・設計:** 詳細なゲームデザイン、UI/UX設計。データ構造、クラス設計など、アーキテクチャの検討。
2.  **プロトタイプ開発:** 基本的なゲームプレイ機能（テトリミノの生成、操作、固定、ラインクリア）の実装。UIの基本的な配置。
3.  **主要機能の実装:** スコア、レベル、Next/Hold表示、ゴーストピースの実装。ゲームオーバー、ポーズ機能の実装。
4.  **UI/UXの改善:** アニメーション、エフェクトの追加。サウンド（BGM, SE）の実装。ユーザーインターフェースの洗練。
5.  **テスト:** 単体テスト、結合テスト、総合テスト。様々な環境での動作確認。
6.  **デプロイ・公開:** 各プラットフォームへのデプロイ準備。公開。

---

### 8. 今後の拡張性（オプション）

* オンライン対戦モード
* タイムアタックモード、マラソンモードなどの異なるゲームモード
* テトリミノのスキン変更機能
* グローバルリーダーボード
* リプレイ機能

---

これでMarkdown形式で正しく記述されているはずです。他に何か調整が必要な点がありましたら、お知らせください。
